build:
  gpu: true
  python_version: "3.10"
  python_packages:
    - torch==2.0.1
    - torchvision==0.15.2
    - diffusers==0.21.4
    - transformers==4.33.2
    - accelerate==0.23.0
    - huggingface-hub==0.16.4
    - opencv-python==4.8.1.78
    - Pillow==10.0.0
    - numpy==1.24.3
    - scikit-image==0.21.0
    - face-alignment==1.3.5
    - mediapipe==0.10.8
    - facexlib==0.3.0
    - spiga==0.0.6
    - requests==2.31.0
    - matplotlib==3.7.2
    - gradio==3.50.2
    - datasets==2.14.6
  run:
    - echo "Installing system dependencies..."
    - apt-get update && apt-get install -y cmake build-essential libboost-all-dev libgtk-3-dev
    - echo "Installing conda and dlib..."
    - wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh
    - bash miniconda.sh -b -p /opt/conda
    - export PATH="/opt/conda/bin:$PATH" && conda tos accept --override-channels --channel https://repo.anaconda.com/pkgs/main && conda tos accept --override-channels --channel https://repo.anaconda.com/pkgs/r && conda install -c conda-forge dlib -y
    - echo "Installing facelib from Git..."
    - pip install git+https://github.com/sajjjadayobi/FaceLib.git@382841efec823f059f49754e5d378abb12cfb551
  system_packages:
    - libgl1-mesa-glx
    - libglib2.0-0
    - libsm6
    - libxext6
    - libxrender-dev
    - libgomp1
    - ffmpeg
    - git

predict: "predict.py:Predictor"
